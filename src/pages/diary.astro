---
// å¯¼å…¥å›½é™…åŒ–é”®åå’Œç¿»è¯‘å‡½æ•°
import I18nKey from "../i18n/i18nKey";
import { i18n } from "../i18n/translation";
// å¯¼å…¥ä¸»å¸ƒå±€ç»„ä»¶
import MainGridLayout from "../layouts/MainGridLayout.astro";
// å¯¼å…¥å›¾ç‰‡åŒ…è£…ç»„ä»¶
import ImageWrapper from "../components/misc/ImageWrapper.astro";

// ç¤ºä¾‹å³åˆ»çŸ­æ–‡æ•°æ®ï¼Œå®é™…é¡¹ç›®å¯æ›¿æ¢ä¸ºåç«¯æ¥å£æ•°æ®
const moments = [
	{
        id: 1,
        content: "è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æç¬”å†™äº›ä¸å…³äºå·¥ä½œå’Œå­¦ä¹ çš„ä¸œè¥¿ï¼Œæ²¡ä»€ä¹ˆå¤æ‚çš„æƒ³æ³•ï¼Œåªæ˜¯æƒ³æŠŠå…³äºå¥¹çš„ã€é‚£äº›ä¼šè®©æˆ‘å·å·å¼€å¿ƒçš„ç¬é—´ï¼Œå¥½å¥½è®°ä¸‹æ¥ï¼Œæ€•æ—¥å­ä¹…äº†æˆ‘å…¨å¿˜è®°äº†ã€‚
æˆ‘å¾ˆæ—©å°±å…³æ³¨åˆ°å¥¹äº†ï¼Œå¤§æ¦‚æ˜¯å¤§ä¸€ååŠæ—¶æœŸå§ï¼Œè¯´èµ·æ¥å¥¹ä¹ŸçœŸæ˜¯ä¸ªå°é€æ˜ï¼Œä¸æ€ä¹ˆåœ¨ç­çº§æ´»è·ƒï¼Œä¹Ÿæ²¡è§å¥¹å‡ºè¿‡ä»€ä¹ˆé£å¤´(è™½ç„¶æˆ‘ä¹ŸæŒºé€æ˜çš„hhï¼‰ï¼Œä»¥è‡´äºæˆ‘ä¸€åº¦ä¸çŸ¥é“å¥¹çš„åå­—ã€‚
æˆ‘ä¸€åº¦é—®è‡ªå·±æˆ‘è¢«å¥¹å¸å¼•çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè®°å¾—ç¬¬ä¸€æ¬¡æ³¨æ„åˆ°å¥¹æ˜¯å¤§è‹±å¬è¯´ï¼Œåœ¨å¤–å›½è¯­å­¦é™¢çš„æ•™å®¤ä¸Šè¯¾ï¼Œæ•™å®¤å¾ˆå°ï¼Œå¥¹å°±ååœ¨æˆ‘çš„å‰æ’ï¼Œå¥¹å’ŒåŒæ¡ŒèŠå¤©æ—¶ç¬‘èµ·æ¥çš„æ„ŸæŸ“åŠ›ï¼Œè®©æˆ‘çªç„¶å¿ƒè·³åŠ é€Ÿã€‚
ä¹‹åï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ„è¯†åˆ°ï¼Œæˆ‘çœ‹åˆ°ä½ çš„æ—¶å€™ï¼Œç›®å…‰æ€»ä¼šä¸ç»æ„çš„å¤šåœç•™ä¸€ä¼šï¼Œè¿™æ˜¯ä¸æ˜¯å–œæ¬¢ï¼Œæˆ‘ä¸æ¸…æ¥šï¼Œä¹Ÿè®¸å¹¶ä¸æ˜¯ï¼Œä½†å°±æ˜¯è«ååœ°åœ¨æ„ä½ ã€‚
ä¸çŸ¥ä¸è§‰ï¼Œå†™ç€æ—¥è®°åƒæ˜¯åœ¨å†™æƒ…ä¹¦ï¼Œç§°è°“ä¹Ÿä»â€œå¥¹â€å˜æˆäº†â€œä½ â€ï¼Œæˆ–è®¸ä»¥åæˆ‘ä»¬å¦‚æœåœ¨ä¸€èµ·äº†ï¼Œæˆ–è€…å¾ˆä¹…ä¹‹åä½ ä¹Ÿèƒ½çœ‹è§è¿™äº›ï¼Œç´¢æ€§å°±ä¸å†æ”¹å›æ¥äº†ã€‚
é‚£ä¹‹åï¼Œæˆ‘è¿˜æ˜¯ä¸çŸ¥é“ä½ çš„åå­—ï¼Œæˆ‘ä¸€åº¦ç”¨æ’é™¤æ³•æ¥æ‰¾åˆ°ä½ çš„åå­—ï¼Œæˆ‘å¯¹ç€å­¦å·ä»ä¸Šåˆ°ä¸‹ï¼Œä½†æ˜¯æˆ‘å…ˆå…¥ä¸ºä¸»çš„è§‚å¿µè¿˜æ˜¯æŠŠæ­£ç¡®é€‰é¡¹æ’é™¤äº†ï¼Œæˆ‘çŸ¥é“æ­£ç¡®ç­”æ¡ˆæ—¶è¿˜æ˜¯ä¸Šé©¬åŸè¯¾ï¼Œä½ å›ç­”é—®é¢˜æŠ¥å‡ºäº†ä½ çš„å­¦å·å’Œå§“åã€‚
æˆ‘è¿™æ‰çŸ¥é“ä½ å«â€œæ¡‘æ¢¦å¨œâ€ã€‚æˆ‘å¾ˆå¼€å¿ƒï¼Œå› ä¸ºæˆ‘ç»ˆäºçŸ¥é“äº†ä½ çš„åå­—ã€‚ä½†åˆ°è¿™ä¸€æ­¥æˆ‘ç”¨äº†å¾ˆé•¿æ—¶é—´ï¼ŒçœŸä¸å®¹æ˜“ã€‚
æˆ‘å½“ç„¶æƒ³è¿‡èƒ½å’Œä½ è°ˆä¸€åœºæ‹çˆ±ï¼Œç”šè‡³å¹»æƒ³èƒ½å’Œä½ å…±åº¦ä½™ç”Ÿï¼Œä½†æˆ‘çš„ç†æ€§å‘Šè¯‰æˆ‘ï¼Œè¿™å¤ªè‚¤æµ…äº†ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰äº’ç›¸äº†è§£è¿‡ï¼Œæˆ‘è¿˜ä¸äº†è§£ä½ ã€‚
æˆ‘æœ‰åœ¨å…³æ³¨ä½ ï¼Œæˆ‘æƒ³å»è®¤è¯†ä½ ï¼Œåªæ˜¯ä»æœ‹å‹åšèµ·ï¼Œä½†æˆ‘ä¸çŸ¥é“å¦‚ä½•å»è®¤è¯†ä½ ï¼Œé‡‘å·¥å®ä¹ æˆ‘ä»¬ä¹Ÿæ²¡æœ‰ä¸€ç»„ï¼Œå­¦ä¹ å°ç»„æˆ‘ä»¬ä¹Ÿä¸æ˜¯ä¸€ç»„ï¼Œçœ‹èµ·æ¥æˆ‘ä»¬ä¼¼ä¹æ²¡æœ‰èƒ½ç›¸è¯†ç›¸çŸ¥çš„ç¼˜åˆ†ï¼Œè¿™å¾ˆé—æ†¾æˆ‘ä¹Ÿå¾ˆå¤±è½ã€‚
æˆ–è®¸æˆ‘å¯ä»¥ä¸»åŠ¨å»åŠ ä½ çš„å¾®ä¿¡ï¼Œä½†æˆ‘æ€»æ˜¯ä¸‹ä¸äº†å†³å¿ƒï¼Œæœ€è¿‘æƒ³è®¤è¯†ä½ çš„å†²åŠ¨è¶Šæ¥è¶Šå¼ºçƒˆï¼Œä½†æˆ‘å†…å‘è…¼è…†å§‹ç»ˆä¸æ•¢å»åŠ ä½ ï¼Œæˆ‘æ˜æ˜çŸ¥é“æœ‰ç­ç¾¤ï¼Œæˆ‘ä¹Ÿä¸æ•¢åŠ ä½ ï¼Œæˆ‘è®¤ä¸ºè¿™å¤ªå”çªäº†ã€‚
ä½†æœ‰ä»€ä¹ˆæœºä¼šèƒ½è®©æˆ‘ä»¬ç›¸è¯†å‘¢ï¼Ÿ
ä»Šå¤©æ˜¯2025.10.25ä¸‹é›¨äº†ï¼Œæˆ‘å»è¥¿é—¨å–å¿«é€’ï¼Œé€”ä¸­å’Œä½ æ“¦è‚©è€Œè¿‡äº†ï¼Œä½ æ‰‹é‡Œæ‹¿ç€å¤–å–ï¼Œè¿˜æ˜¯èƒŒç€ç´«è‰²çš„ä¹¦åŒ…ï¼Œä½†æˆ‘æ˜¯éª‘ç€è½¦çš„ï¼Œæˆ‘ç»è¿‡ä½ çš„æ—¶å€™æ‰ååº”è¿‡æ¥ï¼Œé‚£æ˜¯ä½ ï¼Œä½ ä¸€ä¸ªäººèµ°ç€ï¼Œæˆ‘æœ‰ä¸€ç§å†²åŠ¨ï¼Œæˆ‘æƒ³æŠ˜è¿”å›å»å«ä½ä½ ï¼Œå¸Œæœ›æˆ‘ä»¬èƒ½è®¤è¯†ä¸€ä¸‹ã€‚
ä½†è¿˜æ˜¯æ²¡æœ‰ï¼Œæˆ‘æ€•å“åˆ°ä½ ï¼Œæˆ‘æ›´æ€•ä½ å¯¹æˆ‘æ€åº¦å†·æ·¡ï¼Œæˆ‘å›è¿‡å¤´å»çœ‹ä½ èµ°äº†å¾ˆè¿œ......

", // æ–°å¢æ—¥è®°å†…å®¹
        date: "2025-10-25T09:00:00Z", // æ–°å¢æ—¥è®°çš„æ—¶é—´
        images: ["assets/images/æ´›çªå¸Œå°è„š.jpg"], // æ–°å¢æ—¥è®°çš„å›¾ç‰‡
    },
];

// æ—¶é—´æ ¼å¼åŒ–å‡½æ•°ï¼Œå°†æ—¶é—´è½¬æ¢ä¸ºâ€œå‡ åˆ†é’Ÿå‰/å‡ å°æ—¶å‰/å‡ å¤©å‰â€æ ¼å¼
function formatTime(dateString: string): string {
    const now = new Date(); // å½“å‰æ—¶é—´
    const date = new Date(dateString); // çŸ­æ–‡å‘å¸ƒæ—¶é—´
    const diffInMinutes = Math.floor(
        (now.getTime() - date.getTime()) / (1000 * 60), // è®¡ç®—æ—¶é—´å·®ï¼ˆåˆ†é’Ÿï¼‰
    );

    if (diffInMinutes < 60) {
        // å°äº1å°æ—¶ï¼Œæ˜¾ç¤ºâ€œxxåˆ†é’Ÿå‰â€
        return `${diffInMinutes}${i18n(I18nKey.diaryMinutesAgo)}`;
    }
    if (diffInMinutes < 1440) {
        // å°äº24å°æ—¶ï¼Œæ˜¾ç¤ºâ€œxxå°æ—¶å‰â€
        const hours = Math.floor(diffInMinutes / 60);
        return `${hours}${i18n(I18nKey.diaryHoursAgo)}`;
    }
    // è¶…è¿‡ä¸€å¤©ï¼Œæ˜¾ç¤ºâ€œxxå¤©å‰â€
    const days = Math.floor(diffInMinutes / 1440);
    return `${days}${i18n(I18nKey.diaryDaysAgo)}`;
}
---

// ä¸»å¸ƒå±€ï¼Œé¡µé¢æ ‡é¢˜å’Œæè¿°
<MainGridLayout title={i18n(I18nKey.diary)} description="å³åˆ»çŸ­æ–‡">
    <div class="flex w-full rounded-[var(--radius-large)] overflow-hidden relative min-h-32">
        <div class="card-base z-10 px-4 py-4 md:px-6 md:py-5 relative w-full">
            <div class="relative max-w-4xl mx-auto">
                <!-- é¡µé¢å¤´éƒ¨åŒºåŸŸ -->
                <div class="moments-header mb-6">
                    <div class="header-content">
                        <div class="header-info">
                            <!-- æ ‡é¢˜ -->
                            <h1 class="moments-title text-xl md:text-2xl font-bold text-90 mb-1">{i18n(I18nKey.diary)}</h1>
                            <!-- å‰¯æ ‡é¢˜ -->
                            <p class="moments-subtitle text-sm md:text-base text-75">{i18n(I18nKey.diarySubtitle)}</p>
                        </div>
                        <div class="header-stats">
                            <!-- çŸ­æ–‡ç»Ÿè®¡ä¿¡æ¯ -->
                            <div class="stat-item text-center">
                                <span class="stat-number text-lg md:text-xl font-bold text-[var(--primary)]">{moments.length}</span>
                                <span class="stat-label text-xs md:text-sm text-75">{i18n(I18nKey.diaryCount)}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- çŸ­æ–‡åˆ—è¡¨åŒºåŸŸ -->
                <div class="moments-timeline">
                    <div class="timeline-list space-y-4">
                        {/* éå†æ‰€æœ‰çŸ­æ–‡ï¼Œæ¸²æŸ“æ¯ä¸€æ¡ */}
                        {moments.map(moment => (
                            <div class="moment-item card-base p-4 md:p-5 hover:shadow-lg transition-all" key={moment.id}>
                                <div class="moment-content">
                                    {/* çŸ­æ–‡æ–‡æœ¬å†…å®¹ */}
                                    <p class="moment-text text-sm md:text-base text-90 leading-relaxed mb-3">{moment.content}</p>
                                    
                                    {/* å›¾ç‰‡å±•ç¤ºåŒºï¼Œæ”¯æŒå¤šå¼ å›¾ç‰‡ */}
                                    {moment.images && moment.images.length > 0 && (
                <div class="moment-images grid grid-cols-2 sm:grid-cols-3 gap-2 mb-3">
                    {/* éå†å›¾ç‰‡æ•°ç»„ï¼Œæ¸²æŸ“æ¯å¼ å›¾ç‰‡ */}
                    {moment.images.map((image, index) => (
                        <div class="image-item relative rounded-md overflow-hidden aspect-square cursor-pointer hover:scale-105 transition-transform" key={index}>
                            <ImageWrapper 
                                src={image} 
                                alt={i18n(I18nKey.diaryImage)} // å›¾ç‰‡altæ–‡æœ¬ï¼Œä¾¿äºæ— éšœç¢
                                class="w-full h-full object-cover"
                            />
                        </div>
                    ))}
                </div>
            )}
                                </div>
                                
                                {/* åˆ†å‰²çº¿ */}
                                <hr class="moment-divider border-t border-[var(--line-divider)] my-3" />
                                
                                {/* åº•éƒ¨ä¿¡æ¯åŒºï¼ŒåŒ…æ‹¬æ—¶é—´å’Œæ“ä½œæŒ‰é’® */}
                                <div class="moment-footer flex justify-between items-center">
                                    <div class="moment-time flex items-center gap-1.5 text-75 text-xs md:text-sm">
                                        <i class="time-icon text-xs">ğŸ•</i>
                                        <time datetime={moment.date}>
                                            {formatTime(moment.date)} {/* æ ¼å¼åŒ–åçš„æ—¶é—´æ˜¾ç¤º */}
                                        </time>
                                    </div>
                                    <div class="moment-actions">
                                        {/* å›å¤æŒ‰é’®ï¼Œç‚¹å‡»å¯è§¦å‘å›å¤åŠŸèƒ½ */}
                                        <button class="action-btn reply-btn p-1.5 md:p-2 rounded-md hover:bg-[var(--btn-regular-bg)] transition-colors" title={i18n(I18nKey.diaryReply)}>
                                            <i class="reply-icon text-xs md:text-sm">ğŸ’¬</i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                </div>

                <!-- åº•éƒ¨æç¤ºä¿¡æ¯ -->
                <div class="moments-tips text-center mt-6 text-75 text-xs md:text-sm italic">
                    {i18n(I18nKey.diaryTips)}
                </div>
            </div>
        </div>
    </div>
</MainGridLayout>

<style>
    /* å¡ç‰‡åŸºç¡€æ ·å¼ */
    .card-base {
        background: var(--card-bg);
        border: 1px solid var(--line-divider);
        transition: all 0.3s ease;
    }
    
    /* é¡µé¢å¤´éƒ¨æ ·å¼ï¼Œæ¸å˜èƒŒæ™¯ */
    .moments-header {
        padding: 1rem;
        border-radius: 8px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark, var(--primary)) 100%);
        color: white;
        position: relative;
        overflow: hidden;
    }
    
    /* å¤´éƒ¨å†…å®¹å¸ƒå±€ */
    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative;
        z-index: 1;
    }
    
    /* æ ‡é¢˜æ ·å¼ */
    .moments-title {
        color: white;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }
    
    /* å‰¯æ ‡é¢˜æ ·å¼ */
    .moments-subtitle {
        color: rgba(255, 255, 255, 0.9);
    }
    
    /* ç»Ÿè®¡æ•°å­—æ ·å¼ */
    .stat-number {
        color: white;
    }
    
    /* ç»Ÿè®¡æ ‡ç­¾æ ·å¼ */
    .stat-label {
        color: rgba(255, 255, 255, 0.8);
    }
    
    /* å›¾ç‰‡æ‚¬åœæ”¾å¤§æ•ˆæœ */
    .image-item img {
        transition: transform 0.3s ease;
    }
    
    .image-item:hover img {
        transform: scale(1.05);
    }
    
    /* æ“ä½œæŒ‰é’®åŸºç¡€æ ·å¼ */
    .action-btn {
        background: none;
        border: none;
        cursor: pointer;
        color: var(--text-muted);
    }
    
    /* æ“ä½œæŒ‰é’®æ‚¬åœé«˜äº® */
    .action-btn:hover {
        color: var(--primary);
    }
    
    /* å“åº”å¼è®¾è®¡ï¼šå°å±å¹•é€‚é… */
    @media (max-width: 640px) {
        .moments-header {
            padding: 0.75rem;
        }
        
        .header-content {
            flex-direction: column;
            text-align: center;
            gap: 0.75rem;
        }
        
        .moment-images {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .moment-footer {
            flex-direction: column;
            align-items: flex-start;
            gap: 0.5rem;
        }
    }
    
    /* å“åº”å¼è®¾è®¡ï¼šä¸­ç­‰å±å¹•é€‚é… */
    @media (min-width: 641px) and (max-width: 768px) {
        .moments-header {
            padding: 1rem;
        }
        
        .moment-images {
            grid-template-columns: repeat(3, 1fr);
        }
    }
    
    /* å“åº”å¼è®¾è®¡ï¼šå¤§å±å¹•é€‚é… */
    @media (min-width: 769px) {
        .moments-header {
            padding: 1.25rem;
        }
        
        .moment-images {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            max-width: 450px;
        }
    }
    
    /* ä¼˜åŒ–å°å±å¹•æ˜¾ç¤º */
    @media (max-width: 480px) {
        .card-base {
            margin: 0 -0.5rem;
        }
        
        .moment-item {
            border-radius: 8px;
        }
        
        .moments-header {
            border-radius: 6px;
        }
    }
</style>

<script>
    // å›å¤æŒ‰é’®åŠŸèƒ½ï¼Œé¡µé¢åŠ è½½åä¸ºæ‰€æœ‰å›å¤æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶
    document.addEventListener('DOMContentLoaded', function() {
        const replyBtns = document.querySelectorAll('.reply-btn');
        replyBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                // è¿™é‡Œå¯ä»¥æ·»åŠ å›å¤åŠŸèƒ½ï¼Œç›®å‰ä»…è¾“å‡ºæ—¥å¿—
                console.log('å›å¤åŠŸèƒ½å¾…å®ç°');
            });
        });
    });
</script>